import{r as t,j as e,S as c,T as l,B as A,M as p,U as B,A as xe,z as pe,W as je,I as ge,x as ye}from"./index-C94LjWxh.js";import{l as fe,C as Pe}from"./index-BLSNQ0WD.js";import{L as ve,A as be,D as Ce,f as E}from"./DatePicker-CzX-_7de.js";import{G as r}from"./Grid-CadWwKob.js";import{T as S,S as G}from"./TextField-Cgvji-af.js";import{I as H}from"./InputLabel-Cnbk1tJc.js";import{M as d}from"./MenuItem-COOgUMYe.js";import{S as Se,T as Me}from"./TablePagination-Bm-w6Wrp.js";import{T as De,a as ke,c as I,d as n,b as Te}from"./TableRow-D9gLSdBk.js";import{T as we}from"./TableHead-z8A-iQpx.js";import{P as Ae}from"./Person-0bM3299F.js";import{D as O,a as N,b as U}from"./DialogContent-CtT_Tsm6.js";import{D as V}from"./DialogTitle-B1KuyPDx.js";import{L as q}from"./LoadingButton-Dsc-v8oU.js";import{D as Ie}from"./DialogContentText-BPyELWIe.js";import{S as Le}from"./Snackbar-C8MTT-3n.js";import{A as Re}from"./Alert-ap9Sp5d-.js";const Fe=[{id:1,name:"김민수",nickname:"minsu",isPaid:!0,paymentDate:"2023-05-10",paymentMethod:"계좌이체",amount:5e4},{id:2,name:"이지은",nickname:"jieun",isPaid:!0,paymentDate:"2023-05-05",paymentMethod:"현금",amount:5e4},{id:3,name:"박준호",nickname:"junho",isPaid:!1,paymentDate:null,paymentMethod:null,amount:5e4},{id:4,name:"최수연",nickname:"suyeon",isPaid:!0,paymentDate:"2023-05-15",paymentMethod:"카드",amount:5e4},{id:5,name:"정현우",nickname:"hyunwoo",isPaid:!1,paymentDate:null,paymentMethod:null,amount:5e4}],_e=()=>{const[o,j]=t.useState([]),[M,J]=t.useState([]),[D,K]=t.useState(new Date),[g,Q]=t.useState("all"),[y,X]=t.useState(""),[k,L]=t.useState(0),[f,Y]=t.useState(10),[R,h]=t.useState(!0),[P,u]=t.useState({open:!1,message:"",severity:"success"}),[Z,_]=t.useState(!1),[F,We]=t.useState([]),[ee,se]=t.useState(!1),[m,ae]=t.useState(null),[W,te]=t.useState(""),[$,ne]=t.useState(""),ie=s=>{Q(s.target.value)},re=s=>{X(s.target.value)},le=(s,a)=>{L(a)},oe=s=>{Y(parseInt(s.target.value,10)),L(0)},de=(s,a)=>{const i=o.map(x=>{if(x.id===s){const C=a;return{...x,isPaid:C,paymentDate:C?E(D,"yyyy-MM-dd"):null,paymentMethod:C?"계좌이체":null,statusColor:C?"green":"red"}}return x});j(i);const b=i.find(x=>x.id===s);b.amount*(b.isPaid?1:-1),u({open:!0,message:`${b.name} 회원의 납부 상태가 ${b.isPaid?"납부 완료":"미납"}으로 변경되었습니다.`,severity:"success"})},ce=s=>{const a=o.map(i=>({...i,isPaid:s,paymentDate:E(D,"yyyy-MM-dd"),paymentMethod:"일괄처리",statusColor:"green"}));j(a),u({open:!0,message:"모든 회원의 회비가 납부 처리되었습니다.",severity:"success"})},z=()=>{u({...P,open:!1})};t.useEffect(()=>{const s=setTimeout(()=>{j(Fe),h(!1)},500);return()=>clearTimeout(s)},[]),t.useEffect(()=>{let s=[...o];if(g==="paid"?s=s.filter(a=>a.isPaid):g==="unpaid"&&(s=s.filter(a=>!a.isPaid)),y){const a=y.toLowerCase();s=s.filter(i=>i.name.toLowerCase().includes(a)||i.nickname.toLowerCase().includes(a))}J(s)},[o,g,y]);const v={totalMembers:o.length,paidMembers:o.filter(s=>s.isPaid).length,unpaidMembers:o.filter(s=>!s.isPaid).length,totalAmount:o.filter(s=>s.isPaid).reduce((s,a)=>s+a.amount,0)},he=({status:s})=>{let a,i;switch(s){case"paid":a="success",i="납부완료";break;case"unpaid":a="error",i="미납";break;case"late":a="warning",i="지각납부";break;case"exempt":a="info",i="면제";break;default:a="default",i=s}return e.jsx(ye,{color:a,label:i,size:"small"})},T=()=>{se(!1),ae(null)},ue=()=>{m&&(h(!0),setTimeout(()=>{const s=o.map(a=>a.id===m.id?{...a,isPaid:!0,amount:Number(W),paymentDate:$}:a);j(s),h(!1),T(),u({open:!0,message:"회비 납부가 성공적으로 등록되었습니다.",severity:"success"})},800))},w=()=>{_(!1)},me=()=>{h(!0),setTimeout(()=>{h(!1),w(),u({open:!0,message:`${F.length}명의 회원에게 미납 알림을 전송했습니다.`,severity:"success"})},800)};return e.jsxs(ve,{dateAdapter:be,adapterLocale:fe,children:[e.jsxs(r,{container:!0,spacing:3,children:[e.jsx(r,{item:!0,xs:12,children:e.jsxs(c,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e.jsx(l,{variant:"h5",children:"회비 납부 현황"}),e.jsx(A,{variant:"contained",color:"primary",onClick:()=>ce(!0),children:"전체 납부 처리"})]})}),e.jsx(r,{item:!0,xs:12,sm:6,md:3,children:e.jsx(p,{children:e.jsxs(c,{spacing:1,children:[e.jsx(l,{variant:"h6",color:"textSecondary",children:"전체 회원 수"}),e.jsxs(l,{variant:"h4",children:[v.totalMembers,"명"]})]})})}),e.jsx(r,{item:!0,xs:12,sm:6,md:3,children:e.jsx(p,{children:e.jsxs(c,{spacing:1,children:[e.jsx(l,{variant:"h6",color:"textSecondary",children:"납부 완료 회원"}),e.jsxs(l,{variant:"h4",color:"success.main",children:[v.paidMembers,"명"]})]})})}),e.jsx(r,{item:!0,xs:12,sm:6,md:3,children:e.jsx(p,{children:e.jsxs(c,{spacing:1,children:[e.jsx(l,{variant:"h6",color:"textSecondary",children:"미납 회원"}),e.jsxs(l,{variant:"h4",color:"error.main",children:[v.unpaidMembers,"명"]})]})})}),e.jsx(r,{item:!0,xs:12,sm:6,md:3,children:e.jsx(p,{children:e.jsxs(c,{spacing:1,children:[e.jsx(l,{variant:"h6",color:"textSecondary",children:"총 납부 금액"}),e.jsxs(l,{variant:"h4",color:"primary.main",children:[v.totalAmount.toLocaleString(),"원"]})]})})}),e.jsx(r,{item:!0,xs:12,children:e.jsxs(p,{children:[e.jsxs(c,{direction:{xs:"column",sm:"row"},spacing:2,marginBottom:3,alignItems:"center",children:[e.jsx(Ce,{label:"납부 날짜",value:D,onChange:s=>K(s),renderInput:s=>e.jsx(S,{...s}),inputFormat:"yyyy-MM-dd"}),e.jsxs(B,{sx:{minWidth:120},children:[e.jsx(H,{id:"payment-filter-label",children:"납부 상태"}),e.jsxs(G,{labelId:"payment-filter-label",id:"payment-filter",value:g,label:"납부 상태",onChange:ie,children:[e.jsx(d,{value:"all",children:"전체"}),e.jsx(d,{value:"paid",children:"납부 완료"}),e.jsx(d,{value:"unpaid",children:"미납"})]})]}),e.jsx(S,{label:"회원 검색",variant:"outlined",value:y,onChange:re,placeholder:"이름, 아이디",InputProps:{startAdornment:e.jsx(Se,{fontSize:"small",sx:{mr:1}})},sx:{width:300}})]}),e.jsx(De,{children:e.jsxs(ke,{sx:{minWidth:750},"aria-labelledby":"tableTitle",children:[e.jsx(we,{children:e.jsxs(I,{children:[e.jsx(n,{children:"프로필"}),e.jsx(n,{children:"이름"}),e.jsx(n,{children:"아이디"}),e.jsx(n,{children:"납부 상태"}),e.jsx(n,{children:"납부 금액"}),e.jsx(n,{children:"납부 일자"}),e.jsx(n,{children:"납부 방법"}),e.jsx(n,{children:"납부 처리"})]})}),e.jsxs(Te,{children:[M.slice(k*f,k*f+f).map(s=>e.jsxs(I,{hover:!0,children:[e.jsx(n,{children:e.jsx(xe,{src:`/assets/images/users/avatar-${s.id}.png`,alt:s.name,children:e.jsx(Ae,{})})}),e.jsx(n,{children:s.name}),e.jsx(n,{children:s.nickname}),e.jsx(n,{children:e.jsx(he,{status:s.isPaid?"paid":"unpaid"})}),e.jsxs(n,{children:[s.amount.toLocaleString(),"원"]}),e.jsx(n,{children:s.paymentDate||"-"}),e.jsx(n,{children:s.paymentMethod||"-"}),e.jsx(n,{children:e.jsx(pe,{color:s.isPaid?"success":"error",onClick:a=>{a.stopPropagation(),de(s.id,!s.isPaid)},size:"small",children:s.isPaid?e.jsx(je,{}):e.jsx(Pe,{})})})]},s.id)),M.length===0&&e.jsx(I,{children:e.jsx(n,{colSpan:8,align:"center",children:"회원 정보가 없습니다."})})]})]})}),e.jsx(Me,{rowsPerPageOptions:[5,10,25],component:"div",count:M.length,rowsPerPage:f,page:k,onPageChange:le,onRowsPerPageChange:oe,labelRowsPerPage:"페이지당 행 수:",labelDisplayedRows:({from:s,to:a,count:i})=>`${s}-${a} / 전체 ${i}`})]})})]}),e.jsxs(O,{open:ee,onClose:T,maxWidth:"xs",fullWidth:!0,children:[e.jsx(V,{children:"회비 납부 정보 수정"}),e.jsx(N,{children:e.jsxs(r,{container:!0,spacing:2,sx:{mt:1},children:[e.jsx(r,{item:!0,xs:12,children:e.jsxs(l,{variant:"subtitle2",children:["회원: ",m==null?void 0:m.name]})}),e.jsx(r,{item:!0,xs:12,children:e.jsx(S,{fullWidth:!0,label:"납부 금액",value:W,onChange:s=>te(s.target.value),type:"number",InputProps:{endAdornment:e.jsx(ge,{position:"end",children:"원"})}})}),e.jsx(r,{item:!0,xs:12,children:e.jsx(S,{fullWidth:!0,label:"납부일",type:"date",value:$,onChange:s=>ne(s.target.value),InputLabelProps:{shrink:!0}})}),e.jsx(r,{item:!0,xs:12,children:e.jsxs(B,{fullWidth:!0,children:[e.jsx(H,{children:"납부 방법"}),e.jsxs(G,{label:"납부 방법",defaultValue:"계좌이체",children:[e.jsx(d,{value:"계좌이체",children:"계좌이체"}),e.jsx(d,{value:"카드",children:"카드"}),e.jsx(d,{value:"현금",children:"현금"}),e.jsx(d,{value:"기타",children:"기타"})]})]})})]})}),e.jsxs(U,{children:[e.jsx(A,{onClick:T,children:"취소"}),e.jsx(q,{onClick:ue,loading:R,variant:"contained",color:"primary",children:"저장"})]})]}),e.jsxs(O,{open:Z,onClose:w,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(V,{id:"alert-dialog-title",children:"미납 알림 전송"}),e.jsx(N,{children:e.jsxs(Ie,{id:"alert-dialog-description",children:["현재 ",F.length,"명의 회원이 회비를 미납했습니다. 미납 회원들에게 알림을 전송하시겠습니까?"]})}),e.jsxs(U,{children:[e.jsx(A,{onClick:w,children:"취소"}),e.jsx(q,{onClick:me,loading:R,variant:"contained",color:"primary",autoFocus:!0,children:"알림 전송"})]})]}),e.jsx(Le,{open:P.open,autoHideDuration:3e3,onClose:z,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:e.jsx(Re,{onClose:z,severity:P.severity,sx:{width:"100%"},children:P.message})})]})};export{_e as default};
